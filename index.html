<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Welcome to TFG’s documentation! &#8212; TFG 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="#">
          TFG</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Welcome to TFG&#8217;s documentation!</a></li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
<li><a class="reference internal" href="#testing">Testing</a></li>
<li><a class="reference internal" href="#doxygen-testing">Doxygen testing</a></li>
<li><a class="reference internal" href="#bibliography">Bibliography</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="_sources/index.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="welcome-to-tfg-s-documentation">
<h1>Welcome to TFG&#8217;s documentation!<a class="headerlink" href="#welcome-to-tfg-s-documentation" title="Permalink to this headline">¶</a></h1>
<p>Contents:</p>
<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>
<div class="section" id="testing">
<h1>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h1>
<p>This is a test to know whether the figure automatic numbering really works. See <a class="reference internal" href="#my-figure-ref"><span class="std std-numref">Fig. 1</span></a> if everything&#8217;s fine.</p>
<div class="figure" id="id8">
<span id="my-figure-ref"></span><a class="reference internal image-reference" href="../../../Res/sphinxTest.png"><img alt="map to buried treasure" src="../../../Res/sphinxTest.png" /></a>
<p class="caption"><span class="caption-number">Fig. 1 </span><span class="caption-text">This is the caption of the figure (a simple paragraph).</span></p>
<div class="legend">
The legend consists of all elements after the caption.  In this
case, the legend consists of this paragraph and the following
table.</div>
</div>
</div>
<div class="section" id="doxygen-testing">
<h1>Doxygen testing<a class="headerlink" href="#doxygen-testing" title="Permalink to this headline">¶</a></h1>
<p>This file implements two numerical solvers for systems of N first order ordinary differential equations (y&#8217; = F(x,y)). <p>The first solver, implemented in SolverRK45 and originally called DOPRI5, is
described in [hairer93] and [hairer96]. Specifically, see Table
5.2 [hairer93] for the Butcher&#8217;s table and Section II.4, subsection
&#8220;Automatic Step Size Control&#8221; [hairer93], for the automatic control
of the solver inner step size.
See also Section IV.2 [hairer96] for the stabilized algorithm.
The second solver, SolverRK45, is adapted from [chanrepo16], and
described at [chan13].</p>
</p>
<p>Given an ODEs system, a matrix of initial conditions, each one of the form <span class="math">\( (x_0, y_0) \)</span>, and an interval <span class="math">\( [x_0, x_{end}] \)</span>, this code computes the value of the system at <span class="math">\( x_{end} \)</span> for each one of the initial conditions. The computation is GPU parallelized using CUDA. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Functions</p>
<dl class="function">
<dt>
<span class="target" id="TFGsolvers_8cu_1abc72fb5a61a1d7881b186cba55beb294"></span><code class="descname">static __device__ Real advanceStep(Real * y0, Real h, Real * y1, Real * data)</code></dt>
<dd><p>This method uses DOPRI5 to advance a time of <code class="docutils literal"><span class="pre">h</span></code> the system stored in <code class="docutils literal"><span class="pre">y0</span></code>. It reads the system state passed as <code class="docutils literal"><span class="pre">y0</span></code>, advance it using the step <code class="docutils literal"><span class="pre">h</span></code> and stores the result in <code class="docutils literal"><span class="pre">y1</span></code>. The last parameter, data, is used by the rhs of the system. <dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>The normalized estimated error of the step. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">y0</span></code>: Initial state of the system. </li>
<li><code class="docutils literal"><span class="pre">h</span></code>: Step that shall be advanced. </li>
<li><code class="docutils literal"><span class="pre">y1</span></code>: Final state of the system, </li>
<li><code class="docutils literal"><span class="pre">data</span></code>: Additional data used by the rhs of the system. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt>
<span class="target" id="TFGsolvers_8cu_1aa63690a91dd55db0487c0499251cfdb6"></span><code class="descname">__device__ int bisect(Real * yOriginal, Real * data, Real step, Real x)</code></dt>
<dd><p>This function receives the current state of a ray that has just crossed the equatorial plane (theta = pi/2) and makes a binary search of the exact (with a tolerance of BISECT_TOL) point in which the ray crossed it. This code expects the following:<ul class="simple">
<li>In time = x, the ray is at one side of the equatorial plane.</li>
<li>In time = x - step, the ray was at the opposite side of the equatorial plane.</li>
</ul>
</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>Number of iterations used in the binary search. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">yOriginal</span></code>: Pointer to the array where the ray state is stored, following the usual order used throughout this code: r, theta, phi, pR and pTheta. </li>
<li><code class="docutils literal"><span class="pre">data</span></code>: Device pointer to a serialized matrix of additional data to be passed to computeComonent; currently, this is used to pass the constants b and q of each ray to the computeComponent method. </li>
<li><code class="docutils literal"><span class="pre">step</span></code>: x - step was the last time in which the ray was found in the opposite side of the equatorial plane it is in the current time; i.e., at time = x. </li>
<li><code class="docutils literal"><span class="pre">x</span></code>: Current time. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt>
<span class="target" id="TFGsolvers_8cu_1a178e11898404e5ee33e6002e65afe2a4"></span><code class="descname">__device__ int SolverRK45(Real * globalX0, Real xend, Real * initCond, Real hOrig, Real hmax, Real * data, int * iterations)</code></dt>
<dd><p>Applies the DOPRI5 algorithm over the system defined in the computeComponent function, using the initial conditions specified in <code class="docutils literal"><span class="pre">devX0</span></code> and <code class="docutils literal"><span class="pre">devInitCond</span></code>, and returning the solution found at <code class="docutils literal"><span class="pre">xend</span></code>. <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">globalX0</span></code>: Start of the integration interval [x_0, x_{end}]. At the output, this variable is set to the final time the solver reached. </li>
<li><code class="docutils literal"><span class="pre">xend</span></code>: End of the integration interval [x_0, x_{end}]. </li>
<li><code class="docutils literal"><span class="pre">initCond</span></code>: Device pointer to a serialized matrix of initial conditions; i.e., given a 2D matrix of R rows and C columns, where every entry is an n-tuple of initial conditions (y_0[0], y_0[1], ..., y_0[n-1]), the vector pointed by devInitCond contains R*C*n serialized entries, starting with the first row from left to right, then the second one in the same order and so on. The elements of vector pointed by initCond are replaced with the new computed values at the end of the algorithm; please, make sure you will not need them after calling this procedure. </li>
<li><code class="docutils literal"><span class="pre">hOrig</span></code>: Step size. This code controls automatically the step size, but this value is taken as a test for the first try; furthermore, the method returns the last computed value of h to let the user know the final state of the solver. </li>
<li><code class="docutils literal"><span class="pre">hmax</span></code>: Value of the maximum step size allowed, usually defined as x_{end} - x_0, as we do not to exceed x_{end} in one iteration. </li>
<li><code class="docutils literal"><span class="pre">data</span></code>: Device pointer to a serialized matrix of additional data to be passed to computeComonent; currently, this is used to pass the constants b and q of each ray to the computeComponent method. </li>
<li><code class="docutils literal"><span class="pre">iterations</span></code>: Output variable to know how many iterations were spent in the computation </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<dl class="function">
<dt>
<span class="target" id="TFGsolvers_8cu_1abc72fb5a61a1d7881b186cba55beb294"></span><code class="descname">static __device__ Real advanceStep(Real * y0, Real h, Real * y1, Real * data)</code></dt>
<dd><p>This method uses DOPRI5 to advance a time of <code class="docutils literal"><span class="pre">h</span></code> the system stored in <code class="docutils literal"><span class="pre">y0</span></code>. It reads the system state passed as <code class="docutils literal"><span class="pre">y0</span></code>, advance it using the step <code class="docutils literal"><span class="pre">h</span></code> and stores the result in <code class="docutils literal"><span class="pre">y1</span></code>. The last parameter, data, is used by the rhs of the system. <dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>The normalized estimated error of the step. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">y0</span></code>: Initial state of the system. </li>
<li><code class="docutils literal"><span class="pre">h</span></code>: Step that shall be advanced. </li>
<li><code class="docutils literal"><span class="pre">y1</span></code>: Final state of the system, </li>
<li><code class="docutils literal"><span class="pre">data</span></code>: Additional data used by the rhs of the system. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="section" id="bibliography">
<h1>Bibliography<a class="headerlink" href="#bibliography" title="Permalink to this headline">¶</a></h1>
<p id="bibtex-bibliography-index-0"></p>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2016, Alejandro García Montoro.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>